# API Requirements — Lubowa Sports Park Mobile App

Backend: **WordPress REST API** at `https://lubowasportspark.com`

- **Base URL:** `https://lubowasportspark.com/wp-json`
- **Auth:** Bearer JWT for protected routes. Send header: `Authorization: Bearer <token>`
- **Content-Type:** `application/json` for request bodies

---

## Required for MVP

### 1. Authentication (existing)

| Item | Value |
|------|--------|
| **Namespace** | `jwt-auth/v1` |
| **Login** | POST `/jwt-auth/v1/token` (or plugin-specific path; confirm on site) |
| **Request** | `username`, `password` (JSON body or form) |
| **Response** | `{ "token": "<jwt>", ... }` — app stores token and sends as Bearer on subsequent requests |
| **Who** | Admin login for league management |

**Note:** Validate exact path from JWT Authentication for WP-API plugin (e.g. `/wp-json/jwt-auth/v1/token` or similar). On 401, app should clear token and redirect to login.

---

### 2. Events (existing)

| Item | Value |
|------|--------|
| **Namespace** | `wp/v2` |
| **List** | GET `/wp/v2/posts` |
| **Query** | Optional: `?per_page=20`, `?page=1`, `?categories=<id>` if events use a specific category |
| **Single** | GET `/wp/v2/posts/<id>` |
| **Response** | Standard WP Post: `id`, `title` (object with `rendered`), `content` (object with `rendered`), `date`, `featured_media` (id for image), `excerpt` |
| **Image** | GET `/wp/v2/media/<id>` for featured image URL, or use `_embedded["wp:featuredmedia"]` if available |
| **Who** | Public (no auth) |

**Open point:** Event taxonomy — all posts vs. specific category/custom post type. If filtered, document category ID or CPT slug and add to query params here.

---

### 3. Bookings (custom — to be confirmed)

| Item | Value |
|------|--------|
| **Purpose** | Submit futsal booking request; optionally list user bookings and status |
| **Submit** | POST `<custom path>` e.g. `/bookings` or `/lubowa/v1/bookings` |
| **Request body (suggested)** | `{ "date": "YYYY-MM-DD", "time_slot": "...", "contact_name": "...", "contact_phone": "...", "contact_email": "...", "notes": "..." }` |
| **Response** | 201 + `{ "id": ..., "status": "pending" }` or similar; backend triggers email to admin |
| **List/status (optional for MVP)** | GET `<custom path>` e.g. GET `/bookings?contact_email=...` or by session — returns list of user’s bookings with status |
| **Who** | Submit: public. List: public (by contact) or optional simple auth |

**Action:** Confirm path, request/response shape, and whether “My bookings” is in scope for MVP. Add exact paths and JSON once provided.

---

### 4. Leagues (custom — to be confirmed)

**Admin-only (Bearer JWT required):**

| Operation | Method | Path (suggested) | Request / Response |
|-----------|--------|------------------|----------------------|
| Create league | POST | e.g. `/lubowa/v1/leagues` | Body: `{ "name": "Unique League Name" }` → 201 + league object with `id`, `name`, `code` |
| List leagues | GET | `/lubowa/v1/leagues` | → array of `{ id, name, code, ... }` |
| Add team | POST | `/lubowa/v1/leagues/<id>/teams` | Body: `{ "name": "Team A" }` — unique per league |
| Add player | POST | `/lubowa/v1/teams/<id>/players` | Body: `{ "name": "...", "goals": 0 }` — min 1 per team |
| Generate fixtures | POST | e.g. `/lubowa/v1/leagues/<id>/fixtures/generate` | → list of fixtures |
| Update match score | PATCH/PUT | e.g. `/lubowa/v1/fixtures/<id>` | Body: `{ "home_goals", "away_goals" }` and optionally update player goals |
| Reset/reshuffle fixtures | POST | e.g. `/lubowa/v1/leagues/<id>/fixtures/reset` | — |
| Get league code | GET league | Included in league object | `code` used for public stats |

**Public (no auth):**

| Operation | Method | Path (suggested) | Request / Response |
|-----------|--------|------------------|----------------------|
| Stats by league code | GET | e.g. `/lubowa/v1/leagues/public?code=<code>` or `GET /lubowa/v1/public/leagues/<code>` | → standings, results, fixtures (read-only) |

**Action:** Confirm paths, request/response shapes, and whether league code is generated by backend or app. Document here once provided.

---

## Required for full app (post-MVP)

- Same as above; no additional endpoints strictly required. Optional: push notification endpoint, webhook for booking status updates, or richer league/player stats — to be added here when agreed.

---

## Summary table

| Area | Endpoint type | MVP | Auth |
|------|----------------|-----|------|
| Auth | `jwt-auth/v1` | Yes | — |
| Events | `wp/v2/posts` | Yes | No |
| Bookings | Custom | Yes (submit; list optional) | No (or by contact) |
| Leagues (admin) | Custom | Yes | Bearer JWT |
| Leagues (public) | Custom | Yes | No |

---

## Next steps

1. Confirm or provide exact base path and routes for **bookings** and **leagues** (e.g. namespace and path for each action).
2. Confirm **event taxonomy** (all posts vs. category/CPT) and document query params in this file.
3. Confirm **league code** format and who generates it (backend vs. app).
4. After confirmation, update this doc with final paths and JSON; app will use it as single source of truth for integration.
